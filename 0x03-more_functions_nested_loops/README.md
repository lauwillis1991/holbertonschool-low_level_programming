more nested loops and functions. great..